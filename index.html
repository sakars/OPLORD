<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
<meta charset="utf-8">
<title></title>
<style>
  #myCanvas{
    position: absolute;
    left: 0px;
    top: 0px;
  }
</style>
</head>
<body onload="init();">
<canvas id="myCanvas" width="4000" style="background-color:black"></canvas>

<script src="recycler.js"></script>
<script src="Stops.js"></script>
<script>
//getting background image
  var img=new Image();
  img.src="LV.jpg";
//declaring globbal variables
  var ctx=undefined;
  var stops;
  var width=9.0;
  var height=2.78;
  var left=20.1;
  var ttop=58.28;
  var mid=left+width/2;
  var acth;
  var actw;
  function EyeOpener(Ob,index){//shows all busstops
    var l=coorToCanvas(Ob.degE,Ob.degN);
    stops[index].x=l[0];
    stops[index].y=l[1];
    ctx.fillRect(l[0]-1,l[1]-1,2,2);
  }
  function init(){//initializes canvas and busstops
    ctx=myCanvas.getContext("2d");
    myCanvas.width=window.innerWidth;
    myCanvas.height=window.innerHeight;
    if((window.innerWidth/window.innerHeight)<(img.width/img.height)){
      acth=img.height*(myCanvas.width/img.width);
      actw=myCanvas.width;
    }else{
      acth=myCanvas.height;
      actw=img.width*(myCanvas.height/img.height);
    }
    //myCanvas.height=acth;
    ctx.drawImage(img,0,0,actw,acth);

    recycle();//@recycler.js  Gets all files needed and repurpouses them
    waiter();

  }
  function waiter(){//function that waits until the files are fetched
    if(done==false){//@recycler.js
      setTimeout(waiter,10);
      return;
    }
    stops=reA;//@recycler.js
    ctx.fillStyle="white";

    stops.forEach(EyeOpener);
    setTimeout(update,10);
  }
  function update(){//main update
    setTimeout(update,10);
  }
  function coorToCanvas(E,N){
    var x=(E-left)*actw/width-(E-mid)*2;
    var y=((ttop-N)*acth/height)-Math.pow(E-mid,2)*2;
    return [x,y];
  }
</script>

</body>
</html>
